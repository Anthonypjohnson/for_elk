# Input configuration for forensic log files
# SOF-ELK style: 0000-0999 range for inputs

input {
  # Hayabusa CSV files
  file {
    path => "/usr/share/logstash/data/hayabusa/csv/*.csv"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "hayabusa-csv"
    tags => ["hayabusa", "csv", "windows", "forensics"]
    mode => "read"
  }

  # Hayabusa JSON/JSONL files
  file {
    path => "/usr/share/logstash/data/hayabusa/json/*.json"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => "json"
    type => "hayabusa-json"
    tags => ["hayabusa", "json", "windows", "forensics"]
    mode => "read"
  }

  file {
    path => "/usr/share/logstash/data/hayabusa/json/*.jsonl"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => "json_lines"
    type => "hayabusa-json"
    tags => ["hayabusa", "jsonl", "windows", "forensics"]
    mode => "read"
  }

  # General Windows Event Logs (EVTX exports)
  file {
    path => "/usr/share/logstash/data/input/evtx/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "evtx-raw"
    tags => ["windows", "evtx", "forensics"]
    mode => "read"
  }

  file {
    path => "/usr/share/logstash/data/input/evtx/*.xml"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "evtx-xml"
    tags => ["windows", "evtx", "xml", "forensics"]
    mode => "read"
  }

  # Sysmon logs
  file {
    path => "/usr/share/logstash/data/input/sysmon/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "sysmon"
    tags => ["sysmon", "windows", "forensics"]
    mode => "read"
  }

  file {
    path => "/usr/share/logstash/data/input/sysmon/*.xml"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "sysmon-xml"
    tags => ["sysmon", "windows", "xml", "forensics"]
    mode => "read"
  }

  # PowerShell logs
  file {
    path => "/usr/share/logstash/data/input/powershell/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "powershell"
    tags => ["powershell", "windows", "forensics"]
    mode => "read"
  }

  # Network logs (Zeek, etc.)
  file {
    path => "/usr/share/logstash/data/input/network/*.log"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    type => "network"
    tags => ["network", "forensics"]
    mode => "read"
  }
}
